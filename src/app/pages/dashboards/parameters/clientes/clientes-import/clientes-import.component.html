<section>
    <div>
        <form [formGroup]="frmImportCliente" class="border shadow-lg">
            <div class="modal-header bg-primary">
                <h6 class="text-white">Importar Datos Masivos Clientes</h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-3 col-md-3 col-lg-3">
                        <label>Empresa</label>
                        <ng-select [items]="listEmpresas()" bindLabel="textoMostrar" bindValue="id"
                            formControlName="EmpresaId" [readonly]="true">
                        </ng-select>
                        <app-forms-messages [error]="frmImportCliente.get('EmpresaId')"
                            [statusForm]=statusForm></app-forms-messages>
                    </div>
                    <div class="col-sm-3 col-md-3 col-lg-3">
                        <label>Ciudad</label>
                        <ng-select [items]="listCiudades()" bindLabel="textoMostrar" bindValue="id"
                            formControlName="CiudadId" [readonly]="true">
                        </ng-select>
                        <app-forms-messages [error]="frmImportCliente.get('CiudadId')"
                            [statusForm]=statusForm></app-forms-messages>
                    </div>
                    <div class="col-sm-3 col-md-3 col-lg-3">
                        <button type="button" class="btn btn-outline-secondary mt-4" (click)="downloadFile()"><i
                                class="fa-duotone fa-file-arrow-down"></i> Descargar Plantilla</button>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-3 col-md-3 col-lg-3">
                        <label>Arl</label>
                        <ng-select [items]="listArl()" bindLabel="textoMostrar" bindValue="id" formControlName="ArlId">
                        </ng-select>
                        <app-forms-messages [error]="frmImportCliente.get('ArlId')"
                            [statusForm]=statusForm></app-forms-messages>
                    </div>
                    <div class="col-sm-3 col-md-3 col-lg-3">
                        <label>Curso</label>
                        <ng-select [items]="listCursos()" bindLabel="textoMostrar" bindValue="id"
                            formControlName="CursoId" (change)="onChangeCurso($event)">
                        </ng-select>
                        <app-forms-messages [error]="frmImportCliente.get('CursoId')"
                            [statusForm]="statusForm"></app-forms-messages>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6" *ngIf="curso">
                        <label>Detalle del Curso</label>
                        <ng-select [items]="listCursosDetalles()" bindLabel="textoMostrar" bindValue="id"
                            formControlName="CursoDetalleId">
                        </ng-select>
                        <app-forms-messages [error]="frmImportCliente.get('CursoDetalleId')"
                            [statusForm]="statusForm"></app-forms-messages>
                    </div>
                </div>
                <br>
                <div class="file-upload">
                    <button class="file-upload-btn" type="button"
                        onclick="$('.file-upload-input').trigger( 'click' )">Importar Archivo</button>

                    <div class="archivo-upload-wrap">
                        <input class="file-upload-input" type='file' (change)="readURL($event);" name="excel_File"
                            id="excel_File" required accept=".xlsx" />
                        <div class="drag-text">
                            <h3>Arrastra el Archivo</h3>
                        </div>
                    </div>
                    <div class="file-upload-content">
                        <div class="archivo-title-wrap">
                            <div class="my-4 text-success">
                                <i class="fa-duotone fa-file-csv"></i>&nbsp;&nbsp;<span class="archivo-title"></span>
                            </div>
                            <div class="d-flex justify-content-center">
                                <button type="button" (click)="removeUpload()"
                                    class="btn btn-danger me-2">Quitar</button>
                                <button type="button" (click)="upload()" class="btn btn-success">Subir Archivo</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row float-right">
                    <div class="col-md-12">
                        <app-botones [botones]="botones" (eventCancel)="cancel()"></app-botones>
                    </div>
                </div>
            </div>
        </form>
    </div>
</section>